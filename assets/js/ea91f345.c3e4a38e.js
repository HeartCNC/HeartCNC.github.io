"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1633],{2673:(t,e,i)=>{i.r(e),i.d(e,{default:()=>M});var n=i(9496),r=i(9794),a=i(7214),s=i(6842),h=i(1008),l=i(139),c=i(9119),o=i(344),d=i(8607),m=i(1683),u=i(504),g=i(8775),f=i(164);let w;function y(t){return!(t===w||""===t||null===t)}const v={};let p=1;const x={};function E(t){return/^data:image\/(png|jpg|jpeg);base64/.test(t)}function L(){if(document!==w)return document.createElement("canvas")}class _{constructor(t){this.x=t.x||this.x||0,this.y=t.y||this.y||0,this.width=t.width||this.width||0,this.height=t.height||this.height||0,this.round=Number(t.round||this.round)||0,this.opacity=1,this.angle=0,this.renderer=null}render(){}clip(){const{renderer:t,x:e,y:i,width:n,height:r,round:a}=this;if(0===a)return;const s=a/2;t.beginPath(),t.moveTo(e+s,i),t.arcTo(e+n,i,e+n,i+r,s),t.arcTo(e+n,i+r,e,i+r,s),t.arcTo(e,i+r,e,i,s),t.arcTo(e,i,e+n,i,s),t.closePath(),t.clip()}}const S={left:0,center:.5,right:1};class b extends _{constructor(t,e){super(e),this.text=t||"",this.fillStyle=e.color||"#000",this.fontFamily=e.fontFamily||"normal",this.fontSize=e.fontSize||16,this.fontWeight=e.fontWeight||"normal",this.align=e.align||"left",this.letterSpacing=e.letterSpacing||0,this.lineHeight=e.lineHeight||this.fontSize,this.width=e.width||this.width||0,this.height=e.height||this.height||0,this._width=0,this._height=0}render(){this.renderer.font=`${this.fontWeight} ${this.fontSize}px ${this.fontFamily}`,this.renderer.fillStyle=this.fillStyle,this.renderer.textBaseline="top",this.renderer.textAlign="left";const t=this.text.split("\n").map((t=>t.split("").map((t=>({width:this.renderer.measureText(t).width,char:t,height:this.lineHeight}))))),e=[];t.forEach(((t,i)=>{let n=this.x,r=0;const a=this.y+this.lineHeight*i;t.forEach((t=>{t.x=n,t.y=a,n+=t.width,r+=t.width})),e[i]=r,this._width=Math.max(this._width,r),this._height=Math.max(this._height,a+this.fontSize-this.y)})),t.forEach(((t,i)=>{t.forEach((t=>{this.renderer.fillText(t.char,t.x+(this.width-e[i])*S[this.align],t.y)}))}))}}class k extends _{constructor(t,e){void 0===e&&(e={}),super(e),this._src=t,this.src=t}render(){const t=function(t){if(E(t)){const e=Object.keys(x).find((e=>t===x[e]));return v[e]}return v[t]}(this._src);if(!t)return;this.width=this.width||t.width,this.height=this.height||t.height;const{x:e,y:i,width:n,height:r,renderer:a}=this;this.clip(),a.drawImage(t,e,i,n,r)}}class C extends _{constructor(t){super(t),this.fillStyle=t.fillStyle||this.fillStyle}fill(t){this.renderer.fillStyle=t}stroke(t,e){this.renderer.strokeStyle=e,this.renderer.lineWidth=t}}class N extends C{render(){const{renderer:t,x:e,y:i,width:n,height:r}=this;this.clip(),t.fillStyle=this.fillStyle,t.fillRect(e,i,n,r)}}class Z extends C{render(){this.renderer.beginPath(),this.renderer.arc(0,0,50,0,2*Math.PI,!0)}}class R{constructor(t){this.canvas=null,this.renderer=null,this.children=[],this.init(t)}init(t){t=Object.assign({},t),this.canvas||(t.canvas?this.canvas=t.canvas:this.canvas=L());try{this.renderer=this.canvas.getContext("2d")}catch(e){throw new Error("Invalid Canvas")}return this.canvas.width=t.width,this.canvas.height=t.height,this}async render(){const t=this.children.filter((t=>t instanceof k&&!v[t.src])).map((t=>t.src));await Promise.all(t.filter(y).map((async t=>{const e=await(i=t,new Promise((t=>{const e=new Image;e.crossOrigin="anonymous",e.src=i,e.onload=i=>{t(e)},e.onerror=e=>{console.warn(`Image '${i}' load error.`),t()}})));var i;E(t)?(x[p]=t,v[p++]=e):v[t]=e}))),this.children.forEach((t=>{return(e=t).renderer.save(),e.render(),void e.renderer.restore();var e}))}addChild(t){return t.renderer=this.renderer,this.children.push(t),this}addChildAt(t,e){return e.renderer=this.renderer,this.children.splice(t,0,e),this}text(t,e){return this.addChild(new b(t,e)),this}image(t,e){return this.addChild(new k(t,e)),this}circle(t){return this.addChild(new Z(t)),this}rectangle(t){return this.addChild(new N(t)),this}clear(){return this.renderer.clearRect(0,0,this.canvas.width,this.canvas.height),this.children=[],this}toDataURL(){try{return this.canvas.toDataURL("image/png")}catch(t){return console.error("!!canvas.toDataURL Error",t),""}}async toBlob(){return new Promise((t=>{this.canvas.toBlob(t)}))}}const z=14,D=260,U=D-2*z,I=z+18+D;async function P(t){let{name:e,url:i}=t;const n=await async function(t){const e=await f.toDataURL(t,{margin:0,width:U}),i=new R({width:D,height:I});return i.init({width:D,height:D}).clear().rectangle({fillStyle:"#fff",x:0,y:0,width:D,height:D}).image(e,{x:z,y:z}),await i.render(),i.toDataURL()}(i),r=new R({width:D,height:I});return r.init({width:D,height:I}).clear().rectangle({fillStyle:"#fff",x:0,y:0,width:D,height:I}).text(e,{width:D,fontSize:16,color:"red",letterSpacing:1,x:0,y:z,align:"center"}).image(n,{x:0,y:I-D}),await r.render(),r.toDataURL()}const B="qrcode_data";const T={fontSize:14};function M(){const t=(0,a.Z)(),e=t&&function(){const t=localStorage.getItem(B);return t&&JSON.parse(t)}()||[{name:"",url:""}],[i,f]=(0,n.useState)(e),[w,y]=(0,n.useState)(""),[v,p]=(0,n.useState)("");function x(t,e,n){i[n][e]=t.target.value,f([...i])}function E(){f(e),y(""),p("")}return(0,n.useEffect)((async()=>{var e;t&&(e=i,localStorage.setItem(B,JSON.stringify(e)));const n=i.filter((t=>Boolean(t.url)));if(!n.length)return;const{toDataURL:r,toBlob:a}=await async function(t){const e=t.length,i=Math.ceil(Math.sqrt(e)),n=Math.ceil(e/i),r=i*D,a=n*I,s=new R({width:r,height:a}).clear().rectangle({fillStyle:"#fff",x:0,y:0,width:r,height:a});let h=0,l=0,c=0;for(;c<t.length;)s.image(await P(t[c++]),{x:D*h,y:I*l}),h++,h===i&&(h=0,l++);return await s.render(),{toDataURL:()=>s.toDataURL(),toBlob:async()=>await s.toBlob()}}(n);y(r()),p(await a())}),[i]),n.createElement(r.Z,null,(()=>n.createElement("div",{className:"app"},n.createElement("div",{className:"Result"},n.createElement("img",{src:w,className:"Result__img"})),n.createElement("div",{className:"LinkList"},n.createElement("div",{className:"LinkList__header"},n.createElement(c.Z,{onClick:()=>function(){const t=new ClipboardItem({[v.type]:v});navigator.clipboard.write([t])}(),variant:"contained",size:"small",color:"primary",className:"LinkList__header-btn"},n.createElement(s.Z,{sx:T}),"\u590d\u5236\u56fe\u7247"),n.createElement(c.Z,{onClick:()=>(i.unshift({name:"",url:""}),void f([...i])),variant:"contained",size:"small",color:"primary",className:"LinkList__header-btn"},n.createElement(h.Z,{sx:T}),"\u63d2\u5165\u4e00\u6761"),n.createElement(c.Z,{onClick:()=>(i.push({name:"",url:""}),void f([...i])),variant:"contained",size:"small",color:"primary",className:"LinkList__header-btn"},n.createElement(h.Z,{sx:T}),"\u8ffd\u52a0\u4e00\u6761"),n.createElement(c.Z,{onClick:E,variant:"contained",size:"small",color:"primary",className:"LinkList__header-btn"},n.createElement(l.Z,{sx:T}),"\u6e05\u7a7a")),n.createElement(o.Z,{className:"LinkList__list"},i.map(((t,e)=>n.createElement("div",{key:"rd"+e},0!==e&&n.createElement(d.Z,null),n.createElement(m.ZP,{className:"LinkList__item"},n.createElement("div",{className:"LinkList__info"},n.createElement(u.Z,{label:"\u6807\u9898",variant:"outlined",fullWidth:!0,onChange:t=>x(t,"name",e),value:t.name}),n.createElement(u.Z,{label:"\u94fe\u63a5",placeholder:"\u8f93\u5165\u5185\u5bb9",multiline:!0,rows:4,variant:"outlined",fullWidth:!0,onChange:t=>x(t,"url",e),value:t.url,className:"LinkList__textarea"})),n.createElement("div",{className:"LinkList__actions"},n.createElement(g.Z,{onClick:t=>function(t){1!==i.length?(i.splice(t,1),f([...i])):E()}(e),className:"btn-item",title:"\u5220\u9664"},n.createElement(l.Z,{sx:T}))))))))))))}}}]);